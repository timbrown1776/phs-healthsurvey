DROP TABLE IF EXISTS healthsurvey;

update healthsurvey_csv set nummen = '0.0' where nummen like '%e%';
update healthsurvey_csv set numwomen = '0.0' where numwomen like '%e%';
update healthsurvey_csv set joinpai2 = '0.0' where joinpai2 like '%e%';

select 
	cast(_STATE as decimal),
	cast(fmonth as decimal),
	cast( ( substring(idate from 7 for 4) || substring(idate from 3 for 2) || substring(idate from 5 for 2) ) as decimal) as idate,
	cast(substring(imonth from 3 for 2) as decimal) as imonth,
	cast(substring(iday from 3 for 2) as decimal) as iday,
	cast(substring(iyear from 3 for 4) as decimal) as iyear,
	cast(dispcode as decimal),
	cast(substring(seqno from 3 for 10) as decimal) as seqno,
	cast(_PSU as decimal),
	cast(ctelenm1 as decimal),
	cast(pvtresd1 as decimal),
	cast(colghous as decimal),
	cast(statere1 as decimal),
	cast(celphon1 as decimal),
	cast(ladult1 as decimal),
	cast(colgsex as decimal),
	cast(numadult as decimal),
	cast(landsex as decimal),
	cast(nummen as decimal),
	cast(numwomen as decimal),
	cast(respslct as decimal),
	cast(safetime as decimal),
	cast(ctelnum1 as decimal),
	cast(cellfon5 as decimal),
	cast(cadult1 as decimal),
	cast(cellsex as decimal),
	cast(pvtresd3 as decimal),
	cast(cclghous as decimal),
	cast(cstate1 as decimal),
	cast(landline as decimal),
	cast(hhadult as decimal),
	cast(sexvar as decimal),
	cast(genhlth as decimal),
	cast(physhlth as decimal),
	cast(menthlth as decimal),
	cast(poorhlth as decimal),
	cast(priminsr as decimal),
	cast(persdoc3 as decimal),
	cast(medcost1 as decimal),
	cast(checkup1 as decimal),
	cast(exerany2 as decimal),
	cast(bphigh6 as decimal),
	cast(bpmeds as decimal),
	cast(cholchk3 as decimal),
	cast(toldhi3 as decimal),
	cast(cholmed3 as decimal),
	cast(cvdinfr4 as decimal),
	cast(cvdcrhd4 as decimal),
	cast(cvdstrk3 as decimal),
	cast(asthma3 as decimal),
	cast(asthnow as decimal),
	cast(chcscncr as decimal),
	cast(chcocncr as decimal),
	cast(chccopd3 as decimal),
	cast(addepev3 as decimal),
	cast(chckdny2 as decimal),
	cast(diabete4 as decimal),
	cast(diabage3 as decimal),
	cast(havarth5 as decimal),
	cast(arthexer as decimal),
	cast(arthedu as decimal),
	cast(lmtjoin3 as decimal),
	cast(arthdis2 as decimal),
	cast(joinpai2 as decimal),
	cast(marital as decimal),
	cast(educa as decimal),
	cast(renthom1 as decimal),
	cast(numhhol3 as decimal),
	cast(numphon3 as decimal),
	cast(cpdemo1b as decimal),
	cast(veteran3 as decimal),
	cast(employ1 as decimal),
	cast(children as decimal),
	cast(income3 as decimal),
	cast(pregnant as decimal),
	cast(weight2 as decimal),
	cast(height3 as decimal),
	cast(deaf as decimal),
	cast(blind as decimal),
	cast(decide as decimal),
	cast(diffwalk as decimal),
	cast(diffdres as decimal),
	cast(diffalon as decimal),
	cast(smoke100 as decimal),
	cast(smokday2 as decimal),
	cast(usenow3 as decimal),
	cast(ecignow1 as decimal),
	cast(alcday5 as decimal),
	cast(avedrnk3 as decimal),
	cast(drnk3ge5 as decimal),
	cast(maxdrnks as decimal),
	cast(flushot7 as decimal),
	cast(flshtmy3 as decimal),
	cast(imfvpla2 as decimal),
	cast(pneuvac4 as decimal),
	cast(hivtst7 as decimal),
	cast(hivtstd3 as decimal),
	cast(fruit2 as decimal),
	cast(fruitju2 as decimal),
	cast(fvgreen1 as decimal),
	cast(frenchf1 as decimal),
	cast(potatoe1 as decimal),
	cast(vegetab2 as decimal),
	cast(pdiabtst as decimal),
	cast(prediab1 as decimal),
	cast(insulin1 as decimal),
	cast(bldsugar as decimal),
	cast(feetchk3 as decimal),
	cast(doctdiab as decimal),
	cast(chkhemo3 as decimal),
	cast(feetchk as decimal),
	cast(eyeexam1 as decimal),
	cast(diabeye as decimal),
	cast(diabedu as decimal),
	cast(toldcfs as decimal),
	cast(havecfs as decimal),
	cast(workcfs as decimal),
	cast(toldhepc as decimal),
	cast(trethepc as decimal),
	cast(prirhepc as decimal),
	cast(havehepc as decimal),
	cast(havehepb as decimal),
	cast(medshepb as decimal),
	cast(hpvadvc4 as decimal),
	cast(hpvadsht as decimal),
	cast(tetanus1 as decimal),
	cast(shingle2 as decimal),
	cast(lcsfirst as decimal),
	cast(lcslast as decimal),
	cast(lcsnumcg as decimal),
	cast(lcsctscn as decimal),
	cast(hadmam as decimal),
	cast(howlong as decimal),
	cast(cervscrn as decimal),
	cast(crvclcnc as decimal),
	cast(crvclpap as decimal),
	cast(crvclhpv as decimal),
	cast(hadhyst2 as decimal),
	cast(psatest1 as decimal),
	cast(psatime1 as decimal),
	cast(pcpsars2 as decimal),
	cast(pcstalk as decimal),
	cast(hadsigm4 as decimal),
	cast(colnsigm as decimal),
	cast(colntes1 as decimal),
	cast(sigmtes1 as decimal),
	cast(lastsig4 as decimal),
	cast(colncncr as decimal),
	cast(vircolo1 as decimal),
	cast(vclntes1 as decimal),
	cast(smalstol as decimal),
	cast(stoltest as decimal),
	cast(stooldn1 as decimal),
	cast(bldstfit as decimal),
	cast(sdnates1 as decimal),
	cast(cncrdiff as decimal),
	cast(cncrage as decimal),
	cast(cncrtyp1 as decimal),
	cast(csrvtrt3 as decimal),
	cast(csrvdoc1 as decimal),
	cast(csrvsum as decimal),
	cast(csrvrtrn as decimal),
	cast(csrvinst as decimal),
	cast(csrvinsr as decimal),
	cast(csrvdein as decimal),
	cast(csrvclin as decimal),
	cast(csrvpain as decimal),
	cast(csrvctl2 as decimal),
	cast(hombpchk as decimal),
	cast(homrgchk as decimal),
	cast(wherebp as decimal),
	cast(sharebp as decimal),
	cast(wtchsalt as decimal),
	cast(dradvise as decimal),
	cast(cimemlos as decimal),
	cast(cdhouse as decimal),
	cast(cdassist as decimal),
	cast(cdhelp as decimal),
	cast(cdsocial as decimal),
	cast(cddiscus as decimal),
	cast(caregiv1 as decimal),
	cast(crgvrel4 as decimal),
	cast(crgvlng1 as decimal),
	cast(crgvhrs1 as decimal),
	cast(crgvprb3 as decimal),
	cast(crgvalzd as decimal),
	cast(crgvper1 as decimal),
	cast(crgvhou1 as decimal),
	cast(crgvexpt as decimal),
	cast(acedeprs as decimal),
	cast(acedrink as decimal),
	cast(acedrugs as decimal),
	cast(aceprisn as decimal),
	cast(acedivrc as decimal),
	cast(acepunch as decimal),
	cast(acehurt1 as decimal),
	cast(aceswear as decimal),
	cast(acetouch as decimal),
	cast(acetthem as decimal),
	cast(acehvsex as decimal),
	cast(aceadsaf as decimal),
	cast(aceadned as decimal),
	cast(marijan1 as decimal),
	cast(usemrjn3 as decimal),
	cast(rsnmrjn2 as decimal),
	cast(lastsmk2 as decimal),
	cast(stopsmk2 as decimal),
	cast(firearm5 as decimal),
	cast(gunload as decimal),
	cast(loadulk2 as decimal),
	cast(rcsgendr as decimal),
	cast(rcsrltn2 as decimal),
	cast(casthdx2 as decimal),
	cast(casthno2 as decimal),
	cast(birthsex as decimal),
	cast(somale as decimal),
	cast(sofemale as decimal),
	cast(trnsgndr as decimal),
	cast(qstver as decimal),
	cast(qstlang as decimal),
	cast(_METSTAT as decimal),
	cast(_URBSTAT as decimal),
	cast(mscode as decimal),
	cast(_STSTR as decimal),
	cast(_STRWT as decimal),
	cast(_RAWRAKE as decimal),
	cast(_WT2RAKE as decimal),
	cast(_IMPRACE as decimal),
	cast(_CHISPNC as decimal),
	cast(_CRACE1 as decimal),
	cast(_CPRACE1 as decimal),
	cast(cageg as decimal),
	cast(_CLLCPWT as decimal),
	cast(_DUALUSE as decimal),
	cast(_DUALCOR as decimal),
	cast(_LLCPWT2 as decimal),
	cast(_LLCPWT as decimal),
	cast(_RFHLTH as decimal),
	cast(_PHYS14D as decimal),
	cast(_MENT14D as decimal),
	cast(_HLTHPLN as decimal),
	cast(_HCVU652 as decimal),
	cast(_TOTINDA as decimal),
	cast(_RFHYPE6 as decimal),
	cast(_CHOLCH3 as decimal),
	cast(_RFCHOL3 as decimal),
	cast(_MICHD as decimal),
	cast(_LTASTH1 as decimal),
	cast(_CASTHM1 as decimal),
	cast(_ASTHMS1 as decimal),
	cast(_DRDXAR3 as decimal),
	cast(_LMTACT3 as decimal),
	cast(_LMTWRK3 as decimal),
	cast(_PRACE1 as decimal),
	cast(_MRACE1 as decimal),
	cast(_HISPANC as decimal),
	cast(_RACE as decimal),
	cast(_RACEG21 as decimal),
	cast(_RACEGR3 as decimal),
	cast(_RACEPRV as decimal),
	cast(_SEX as decimal),
	cast(_AGEG5YR as decimal),
	cast(_AGE65YR as decimal),
	cast(_AGE80 as decimal),
	cast(_AGE_G as decimal),
	cast(htin4 as decimal),
	cast(htm4 as decimal),
	cast(wtkg3 as decimal),
	cast(_BMI5 as decimal),
	cast(_BMI5CAT as decimal),
	cast(_RFBMI5 as decimal),
	cast(_CHLDCNT as decimal),
	cast(_EDUCAG as decimal),
	cast(_INCOMG1 as decimal),
	cast(_SMOKER3 as decimal),
	cast(_RFSMOK3 as decimal),
	cast(_CURECI1 as decimal),
	cast(drnkany5 as decimal),
	cast(drocdy3_ as decimal),
	cast(_RFBING5 as decimal),
	cast(_DRNKWK1 as decimal),
	cast(_RFDRHV7 as decimal),
	cast(_FLSHOT7 as decimal),
	cast(_PNEUMO3 as decimal),
	cast(_AIDTST4 as decimal),
	cast(ftjuda2_ as decimal),
	cast(frutda2_ as decimal),
	cast(grenda1_ as decimal),
	cast(frnchda_ as decimal),
	cast(potada1_ as decimal),
	cast(vegeda2_ as decimal),
	cast(_MISFRT1 as decimal),
	cast(_MISVEG1 as decimal),
	cast(_FRTRES1 as decimal),
	cast(_VEGRES1 as decimal),
	cast(_FRUTSU1 as decimal),
	cast(_VEGESU1 as decimal),
	cast(_FRTLT1A as decimal),
	cast(_VEGLT1A as decimal),
	cast(_FRT16A as decimal),
	cast(_VEG23A as decimal),
	cast(_FRUITE1 as decimal),
	cast(_VEGETE1 as decimal)
into healthsurvey
from healthsurvey_csv;


select count(*) from healthsurvey ;